# ç°ä»£åŒ– Git è®¤è¯æ¶æ„ - æœ€ä½³æ–¹æ¡ˆ

## ğŸ¯ è®¾è®¡ç›®æ ‡

1. **ç”¨æˆ·ä½“éªŒä¼˜å…ˆ**ï¼šç®€å•ã€ç›´è§‚ã€é›¶é…ç½®
2. **ä¼ä¸šçº§å®‰å…¨**ï¼šç»†ç²’åº¦æƒé™ã€å®¡è®¡å‹å¥½
3. **é«˜å¯ç”¨æ€§**ï¼šä¸ä¾èµ–ä¸ªäººè´¦æˆ·ã€è‡ªåŠ¨æ•…éšœè½¬ç§»
4. **å¯æ‰©å±•æ€§**ï¼šæ”¯æŒå¤šç§è®¤è¯æ–¹å¼ã€å¹³æ»‘å‡çº§
5. **äº‘åŸç”Ÿ**ï¼šHTTPS ä¼˜å…ˆã€Kubernetes å‹å¥½

## ğŸ† æœ€ä½³æ–¹æ¡ˆï¼šåˆ†å±‚è®¤è¯æ¶æ„

### æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç”¨æˆ·å±‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚ ä¸ªäººç”¨æˆ· â”‚  â”‚ å›¢é˜Ÿæˆå‘˜ â”‚  â”‚ ç»„ç»‡ç®¡ç† â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    è®¤è¯ç­–ç•¥å±‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  æ™ºèƒ½è·¯ç”±ï¼šæ ¹æ®åœºæ™¯è‡ªåŠ¨é€‰æ‹©æœ€ä½³è®¤è¯æ–¹å¼              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    è®¤è¯æä¾›è€…å±‚                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  OAuth   â”‚  â”‚   PAT    â”‚  â”‚ GitHub   â”‚  â”‚  GitLab  â”‚  â”‚
â”‚  â”‚  Token   â”‚  â”‚  Token   â”‚  â”‚   App    â”‚  â”‚  Group   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ‰§è¡Œå±‚ (Flux CD)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  HTTPS + Basic Auth â†’ Git Repository                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¨ æ ¸å¿ƒè®¾è®¡

### 1. æ™ºèƒ½è®¤è¯ç­–ç•¥

```typescript
/**
 * è®¤è¯ç­–ç•¥å¼•æ“
 * æ ¹æ®é¡¹ç›®ç±»å‹ã€ç”¨æˆ·è§’è‰²ã€ä»“åº“ä½ç½®è‡ªåŠ¨é€‰æ‹©æœ€ä½³è®¤è¯æ–¹å¼
 */
class GitAuthStrategy {
  async selectBestAuth(context: {
    project: Project
    repository: Repository
    user: User
    organization?: Organization
  }): Promise<AuthMethod> {
    
    // è§„åˆ™ 1: ç»„ç»‡ä»“åº“ä¼˜å…ˆä½¿ç”¨ç»„ç»‡çº§å‡­è¯
    if (context.repository.owner.type === 'organization') {
      const orgAuth = await this.getOrganizationAuth(context.organization)
      if (orgAuth) return orgAuth
    }
    
    // è§„åˆ™ 2: ä¼ä¸šç”¨æˆ·ä¼˜å…ˆä½¿ç”¨ GitHub App
    if (context.organization?.plan === 'enterprise') {
      const appAuth = await this.getGitHubAppAuth(context.organization)
      if (appAuth) return appAuth
    }
    
    // è§„åˆ™ 3: å›¢é˜Ÿé¡¹ç›®ä½¿ç”¨å…±äº«å‡­è¯
    if (context.project.teamId) {
      const teamAuth = await this.getTeamAuth(context.project.teamId)
      if (teamAuth) return teamAuth
    }
    
    // è§„åˆ™ 4: ä¸ªäººé¡¹ç›®ä½¿ç”¨ OAuth Tokenï¼ˆé»˜è®¤ï¼‰
    return await this.getUserOAuthToken(context.user)
  }
}
```

### 2. ç»Ÿä¸€çš„å‡­è¯æ¥å£

```typescript
/**
 * ç»Ÿä¸€çš„ Git å‡­è¯æ¥å£
 * æ‰€æœ‰è®¤è¯æ–¹å¼éƒ½å®ç°è¿™ä¸ªæ¥å£
 */
interface GitCredential {
  id: string
  type: 'oauth' | 'pat' | 'github_app' | 'gitlab_group' | 'deploy_key'
  
  // è·å–è®¿é—®å‡­è¯
  getAccessToken(): Promise<string>
  
  // éªŒè¯å‡­è¯æ˜¯å¦æœ‰æ•ˆ
  validate(): Promise<boolean>
  
  // åˆ·æ–°å‡­è¯ï¼ˆå¦‚æœæ”¯æŒï¼‰
  refresh?(): Promise<void>
  
  // è·å–æƒé™èŒƒå›´
  getScopes(): string[]
  
  // æ£€æŸ¥æ˜¯å¦æœ‰ç‰¹å®šæƒé™
  hasPermission(permission: string): boolean
  
  // è·å–å‡­è¯å…ƒæ•°æ®
  getMetadata(): CredentialMetadata
}

/**
 * OAuth Token å®ç°
 */
class OAuthCredential implements GitCredential {
  type = 'oauth' as const
  
  constructor(
    private oauthAccount: OAuthAccount,
    private oauthService: OAuthAccountsService
  ) {}
  
  async getAccessToken(): Promise<string> {
    // è‡ªåŠ¨åˆ·æ–°è¿‡æœŸçš„ token
    const account = await this.oauthService.getAccountByProvider(
      this.oauthAccount.userId,
      this.oauthAccount.provider
    )
    return account.accessToken
  }
  
  async validate(): Promise<boolean> {
    try {
      const token = await this.getAccessToken()
      // è°ƒç”¨ Git API éªŒè¯
      return await this.validateWithGitAPI(token)
    } catch {
      return false
    }
  }
  
  getScopes(): string[] {
    return this.oauthAccount.provider === 'github' 
      ? ['repo', 'workflow']
      : ['api', 'write_repository']
  }
}

/**
 * GitHub App å®ç°
 */
class GitHubAppCredential implements GitCredential {
  type = 'github_app' as const
  
  async getAccessToken(): Promise<string> {
    // ä½¿ç”¨ GitHub App ç”Ÿæˆ installation token
    const jwt = this.generateJWT()
    const installationToken = await this.getInstallationToken(jwt)
    return installationToken
  }
  
  async refresh(): Promise<void> {
    // GitHub App token 1 å°æ—¶è¿‡æœŸï¼Œè‡ªåŠ¨åˆ·æ–°
    this.cachedToken = await this.getAccessToken()
  }
  
  getScopes(): string[] {
    // GitHub App æƒé™æ›´ç»†ç²’åº¦
    return ['contents:read', 'metadata:read', 'workflows:write']
  }
}
```

### 3. å‡­è¯ç”Ÿå‘½å‘¨æœŸç®¡ç†

```typescript
/**
 * å‡­è¯ç®¡ç†å™¨
 * è´Ÿè´£å‡­è¯çš„åˆ›å»ºã€æ›´æ–°ã€éªŒè¯ã€æ’¤é”€
 */
class CredentialManager {
  
  /**
   * åˆ›å»ºé¡¹ç›®å‡­è¯
   * è‡ªåŠ¨é€‰æ‹©æœ€ä½³è®¤è¯æ–¹å¼
   */
  async createProjectCredential(
    projectId: string,
    options?: {
      preferredType?: AuthType
      customToken?: string
    }
  ): Promise<GitCredential> {
    
    const project = await this.getProject(projectId)
    const user = await this.getUser(project.createdBy)
    const repository = await this.getRepository(project.repositoryId)
    
    // æ™ºèƒ½é€‰æ‹©è®¤è¯æ–¹å¼
    const strategy = new GitAuthStrategy()
    const authMethod = await strategy.selectBestAuth({
      project,
      repository,
      user,
      organization: project.organization
    })
    
    // åˆ›å»ºå‡­è¯è®°å½•
    const credential = await this.db.insert(projectGitAuth).values({
      projectId,
      authType: authMethod.type,
      ...authMethod.config
    })
    
    // åˆ›å»º K8s Secret
    await this.syncToK8s(credential)
    
    return credential
  }
  
  /**
   * å¥åº·æ£€æŸ¥
   * å®šæœŸéªŒè¯å‡­è¯æ˜¯å¦æœ‰æ•ˆ
   */
  async healthCheck(projectId: string): Promise<HealthStatus> {
    const credential = await this.getProjectCredential(projectId)
    const isValid = await credential.validate()
    
    if (!isValid) {
      // å°è¯•è‡ªåŠ¨ä¿®å¤
      const fixed = await this.autoFix(credential)
      if (fixed) {
        return { status: 'healthy', message: 'Auto-fixed' }
      }
      
      // é€šçŸ¥ç”¨æˆ·
      await this.notifyCredentialIssue(projectId)
      return { status: 'unhealthy', message: 'Credential invalid' }
    }
    
    return { status: 'healthy' }
  }
  
  /**
   * è‡ªåŠ¨ä¿®å¤
   * å°è¯•åˆ·æ–°æˆ–åˆ‡æ¢åˆ°å¤‡ç”¨å‡­è¯
   */
  private async autoFix(credential: GitCredential): Promise<boolean> {
    // 1. å°è¯•åˆ·æ–°
    if (credential.refresh) {
      try {
        await credential.refresh()
        return true
      } catch {}
    }
    
    // 2. å°è¯•åˆ‡æ¢åˆ°å¤‡ç”¨å‡­è¯
    const fallback = await this.getFallbackCredential(credential)
    if (fallback) {
      await this.switchCredential(credential.id, fallback)
      return true
    }
    
    return false
  }
  
  /**
   * åŒæ­¥åˆ° K8s
   * æ›´æ–°æ‰€æœ‰ç¯å¢ƒçš„ Secret
   */
  private async syncToK8s(credential: ProjectGitAuth): Promise<void> {
    const environments = await this.getProjectEnvironments(credential.projectId)
    const token = await this.resolveToken(credential)
    
    for (const env of environments) {
      const namespace = `project-${credential.projectId}-${env.type}`
      const secretName = `${credential.projectId}-git-auth`
      
      await this.k8s.createOrUpdateSecret(
        namespace,
        secretName,
        {
          username: this.getUsername(credential.authType),
          password: token
        },
        'kubernetes.io/basic-auth'
      )
    }
  }
}
```

### 4. å¤šç§Ÿæˆ·æ”¯æŒ

```typescript
/**
 * ç»„ç»‡çº§å‡­è¯ç®¡ç†
 * æ”¯æŒç»„ç»‡å…±äº«å‡­è¯
 */
class OrganizationCredentialService {
  
  /**
   * ä¸ºç»„ç»‡é…ç½® GitHub App
   */
  async setupGitHubApp(
    organizationId: string,
    config: {
      appId: string
      installationId: string
      privateKey: string
    }
  ): Promise<void> {
    
    // å­˜å‚¨ GitHub App é…ç½®
    await this.db.insert(organizationGitAuth).values({
      organizationId,
      authType: 'github_app',
      config: {
        appId: config.appId,
        installationId: config.installationId,
        privateKey: await this.encrypt(config.privateKey)
      }
    })
    
    // éªŒè¯é…ç½®
    const credential = new GitHubAppCredential(config)
    const isValid = await credential.validate()
    
    if (!isValid) {
      throw new Error('GitHub App configuration invalid')
    }
  }
  
  /**
   * ç»„ç»‡å†…çš„æ‰€æœ‰é¡¹ç›®è‡ªåŠ¨ä½¿ç”¨ç»„ç»‡å‡­è¯
   */
  async applyToProjects(organizationId: string): Promise<void> {
    const projects = await this.getOrganizationProjects(organizationId)
    const orgAuth = await this.getOrganizationAuth(organizationId)
    
    for (const project of projects) {
      // è¿ç§»åˆ°ç»„ç»‡å‡­è¯
      await this.credentialManager.switchCredential(
        project.id,
        orgAuth
      )
    }
  }
}
```

## ğŸš€ å®æ–½è·¯çº¿å›¾

### Phase 1: åŸºç¡€ï¼ˆå½“å‰ï¼‰âœ…

**ç›®æ ‡**ï¼šè§£å†³ç½‘ç»œé—®é¢˜ï¼Œæ”¯æŒåŸºæœ¬åœºæ™¯

**å®ç°**ï¼š
- âœ… OAuth Token è®¤è¯
- âœ… HTTPS åè®®
- âœ… è‡ªåŠ¨ token åˆ·æ–°ï¼ˆGitLabï¼‰
- âœ… åŸºæœ¬çš„å¥åº·æ£€æŸ¥

**é€‚ç”¨**ï¼šä¸ªäººç”¨æˆ·ã€å°å›¢é˜Ÿ

### Phase 2: å¢å¼ºï¼ˆ1-2 ä¸ªæœˆï¼‰ğŸš§

**ç›®æ ‡**ï¼šæå‡å¯é æ€§å’Œç”¨æˆ·ä½“éªŒ

**å®ç°**ï¼š
- ğŸš§ æ™ºèƒ½è®¤è¯ç­–ç•¥
- ğŸš§ å‡­è¯å¥åº·ç›‘æ§
- ğŸš§ è‡ªåŠ¨æ•…éšœè½¬ç§»
- ğŸš§ K8s Secret è‡ªåŠ¨æ›´æ–°
- ğŸš§ ç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º

**é€‚ç”¨**ï¼šä¸­å‹å›¢é˜Ÿã€æ´»è·ƒç”¨æˆ·

### Phase 3: ä¼ä¸šçº§ï¼ˆ3-6 ä¸ªæœˆï¼‰ğŸ“‹

**ç›®æ ‡**ï¼šæ”¯æŒä¼ä¸šåœºæ™¯

**å®ç°**ï¼š
- ğŸ“‹ Fine-grained PAT æ”¯æŒ
- ğŸ“‹ GitHub App é›†æˆ
- ğŸ“‹ GitLab Group Token
- ğŸ“‹ ç»„ç»‡çº§å‡­è¯ç®¡ç†
- ğŸ“‹ å¤šè®¤è¯æ–¹å¼å¹¶å­˜
- ğŸ“‹ å‡­è¯å®¡è®¡æ—¥å¿—

**é€‚ç”¨**ï¼šä¼ä¸šç”¨æˆ·ã€å¤§å‹ç»„ç»‡

### Phase 4: é«˜çº§ï¼ˆ6-12 ä¸ªæœˆï¼‰ğŸ”®

**ç›®æ ‡**ï¼šå®Œæ•´çš„ä¼ä¸šçº§åŠŸèƒ½

**å®ç°**ï¼š
- ğŸ”® Service Account å®Œæ•´æ”¯æŒ
- ğŸ”® å‡­è¯è½®æ¢ç­–ç•¥
- ğŸ”® åˆè§„æ€§æŠ¥å‘Š
- ğŸ”® å¤šäº‘æ”¯æŒï¼ˆAWS CodeCommit, Azure Reposï¼‰
- ğŸ”® è‡ªå®šä¹‰è®¤è¯æ’ä»¶
- ğŸ”® é›¶ä¿¡ä»»æ¶æ„

**é€‚ç”¨**ï¼šå¤§å‹ä¼ä¸šã€é‡‘èæœºæ„

## ğŸ“Š æ–¹æ¡ˆå¯¹æ¯”

### å½“å‰æ–¹æ¡ˆ vs æœ€ä½³æ–¹æ¡ˆ

| ç»´åº¦ | å½“å‰æ–¹æ¡ˆ | æœ€ä½³æ–¹æ¡ˆ | æå‡ |
|------|---------|---------|------|
| ç”¨æˆ·ä½“éªŒ | â­â­â­â­ | â­â­â­â­â­ | +25% |
| å¯é æ€§ | â­â­â­ | â­â­â­â­â­ | +67% |
| å®‰å…¨æ€§ | â­â­â­ | â­â­â­â­â­ | +67% |
| å¯æ‰©å±•æ€§ | â­â­ | â­â­â­â­â­ | +150% |
| ä¼ä¸šå°±ç»ª | â­â­ | â­â­â­â­â­ | +150% |
| å®ç°å¤æ‚åº¦ | ç®€å• | ä¸­ç­‰ | +50% |
| å¼€å‘æ—¶é—´ | 1-2 å¤© | 2-4 å‘¨ | +10x |

## ğŸ¯ æ¨èç­–ç•¥

### å¯¹äºä½ çš„å¹³å°ï¼ˆAI DevOps Platformï¼‰

**ç«‹å³é‡‡ç”¨**ï¼šPhase 1ï¼ˆOAuth Tokenï¼‰
- âœ… å¿«é€Ÿè§£å†³ç½‘ç»œé—®é¢˜
- âœ… æ»¡è¶³ MVP éœ€æ±‚
- âœ… ç”¨æˆ·ä½“éªŒå¥½

**å¹¶è¡Œå¼€å‘**ï¼šPhase 2ï¼ˆå¢å¼ºåŠŸèƒ½ï¼‰
- ğŸš§ æå‡å¯é æ€§
- ğŸš§ ä¸ºä¼ä¸šåŠŸèƒ½æ‰“åŸºç¡€
- ğŸš§ æ”¶é›†ç”¨æˆ·åé¦ˆ

**æ ¹æ®éœ€æ±‚**ï¼šPhase 3-4ï¼ˆä¼ä¸šåŠŸèƒ½ï¼‰
- ğŸ“‹ æ ¹æ®ç”¨æˆ·åé¦ˆå†³å®šä¼˜å…ˆçº§
- ğŸ“‹ é€æ­¥æ·»åŠ ä¼ä¸šåŠŸèƒ½
- ğŸ“‹ ä¿æŒæ¶æ„çµæ´»æ€§

## ğŸ’¡ å…³é”®è®¾è®¡åŸåˆ™

### 1. æ¸è¿›å¼å¢å¼º

```
åŸºç¡€åŠŸèƒ½ï¼ˆOAuth Tokenï¼‰
    â†“ å¯é€‰å‡çº§
å¢å¼ºåŠŸèƒ½ï¼ˆæ™ºèƒ½ç­–ç•¥ï¼‰
    â†“ å¯é€‰å‡çº§
ä¼ä¸šåŠŸèƒ½ï¼ˆGitHub Appï¼‰
    â†“ å¯é€‰å‡çº§
é«˜çº§åŠŸèƒ½ï¼ˆService Accountï¼‰
```

### 2. å‘åå…¼å®¹

```typescript
// æ–°åŠŸèƒ½ä¸å½±å“ç°æœ‰ç”¨æˆ·
if (project.authType === 'oauth') {
  // ç»§ç»­ä½¿ç”¨ OAuth Token
} else if (project.authType === 'github_app') {
  // ä½¿ç”¨æ–°çš„ GitHub App
}
```

### 3. ç”¨æˆ·é€‰æ‹©æƒ

```typescript
// è®©ç”¨æˆ·é€‰æ‹©è®¤è¯æ–¹å¼
interface CreateProjectInput {
  authStrategy: 'auto' | 'oauth' | 'pat' | 'github_app'
  
  // auto: å¹³å°è‡ªåŠ¨é€‰æ‹©æœ€ä½³æ–¹å¼ï¼ˆæ¨èï¼‰
  // oauth: ä½¿ç”¨ OAuth Tokenï¼ˆç®€å•ï¼‰
  // pat: ä½¿ç”¨ Personal Access Tokenï¼ˆçµæ´»ï¼‰
  // github_app: ä½¿ç”¨ GitHub Appï¼ˆä¼ä¸šï¼‰
}
```

### 4. æ•…éšœè‡ªæ„ˆ

```typescript
// è‡ªåŠ¨æ£€æµ‹å’Œä¿®å¤é—®é¢˜
class SelfHealingCredential {
  async execute() {
    // 1. å¥åº·æ£€æŸ¥
    const health = await this.healthCheck()
    
    // 2. è‡ªåŠ¨ä¿®å¤
    if (!health.ok) {
      await this.autoFix()
    }
    
    // 3. é€šçŸ¥ç”¨æˆ·ï¼ˆå¦‚æœæ— æ³•è‡ªåŠ¨ä¿®å¤ï¼‰
    if (!health.ok) {
      await this.notifyUser()
    }
  }
}
```

## ğŸ ç»“è®º

**æœ€ä½³æ–¹æ¡ˆ = åˆ†å±‚è®¤è¯æ¶æ„ + æ¸è¿›å¼å®æ–½**

**æ ¸å¿ƒä¼˜åŠ¿**ï¼š
1. âœ… ç”¨æˆ·ä½“éªŒä¼˜å…ˆï¼ˆé›¶é…ç½®å¼€å§‹ï¼‰
2. âœ… ä¼ä¸šçº§å®‰å…¨ï¼ˆç»†ç²’åº¦æƒé™ï¼‰
3. âœ… é«˜å¯ç”¨æ€§ï¼ˆè‡ªåŠ¨æ•…éšœè½¬ç§»ï¼‰
4. âœ… å¯æ‰©å±•æ€§ï¼ˆæ”¯æŒå¤šç§è®¤è¯ï¼‰
5. âœ… å¹³æ»‘å‡çº§ï¼ˆå‘åå…¼å®¹ï¼‰

**å®æ–½å»ºè®®**ï¼š
- **ç°åœ¨**ï¼šä½¿ç”¨ OAuth Tokenï¼ˆPhase 1ï¼‰
- **1-2 ä¸ªæœˆ**ï¼šæ·»åŠ æ™ºèƒ½ç­–ç•¥ï¼ˆPhase 2ï¼‰
- **3-6 ä¸ªæœˆ**ï¼šæ”¯æŒä¼ä¸šåŠŸèƒ½ï¼ˆPhase 3ï¼‰
- **æŒç»­è¿­ä»£**ï¼šæ ¹æ®ç”¨æˆ·åé¦ˆä¼˜åŒ–

è¿™ä¸ªæ–¹æ¡ˆæ—¢èƒ½å¿«é€Ÿè§£å†³å½“å‰é—®é¢˜ï¼Œåˆä¸ºæœªæ¥çš„ä¼ä¸šçº§åŠŸèƒ½é¢„ç•™äº†å……è¶³çš„æ‰©å±•ç©ºé—´ã€‚
