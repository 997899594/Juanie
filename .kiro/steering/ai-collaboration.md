---
inclusion: always
---

# AI 协作效率指南

## 核心目标

**让 AI 助手能够快速、准确地理解需求，并提供最优解决方案。**

## 提问和需求描述原则

### 1. 明确具体的需求

**✅ 好的需求描述：**
```
我需要在项目详情页添加一个"重新初始化"按钮，
当项目初始化失败时显示，点击后重新触发初始化流程。
```

**❌ 模糊的需求：**
```
项目有问题，帮我看看
```

### 2. 提供上下文信息

**包含这些信息会更高效：**
- 当前在做什么功能
- 遇到了什么问题（错误信息、日志）
- 期望的行为是什么
- 已经尝试过什么方案

**示例：**
```
我在实现 GitOps 初始化功能，使用 Flux CD 创建 GitRepository 资源。
当前问题：GitRepository 一直处于 Pending 状态
错误日志：SSH host key verification failed
期望：能够自动验证 SSH host key
已尝试：手动添加 known_hosts，但重启后丢失
```

### 3. 说明技术偏好

如果有特定的技术偏好，请明确说明：
- 使用某个特定的库
- 遵循某种设计模式
- 性能要求
- 兼容性要求

## AI 工作方式

### 1. 优先使用工具而非手写

AI 会优先考虑：
1. 是否有现成的 npm 包
2. 框架是否提供了官方方案
3. 项目中是否已有类似实现
4. 行业最佳实践是什么

### 2. 提供完整的解决方案

AI 会提供：
- 完整的代码实现（而非片段）
- 必要的类型定义
- 错误处理
- 相关的配置更新
- 测试建议（如果需要）

### 3. 解释技术选择

AI 会说明：
- 为什么选择这个方案
- 有哪些替代方案
- 这个方案的优缺点
- 需要注意的事项

## 高效协作的技巧

### 1. 使用项目术语

使用项目中已有的术语和概念：
- "项目初始化状态机"而非"项目创建流程"
- "GitOps 事件处理器"而非"Git 相关的东西"
- "三层服务架构"而非"服务层"

### 2. 引用具体文件

当讨论代码时，引用具体的文件路径：
```
packages/services/business/src/projects/project-initialization.service.ts
中的 initializeProject 方法需要添加重试逻辑
```

### 3. 分步骤处理复杂需求

对于复杂功能，可以分步骤：
1. 先讨论架构设计
2. 确认技术方案
3. 实现核心功能
4. 添加错误处理
5. 优化和测试

### 4. 及时反馈

如果 AI 的方案不符合预期：
- 说明哪里不符合预期
- 提供更多上下文
- 说明你的真实需求

## AI 能做什么

### ✅ AI 擅长的任务

1. **代码实现**
   - 实现新功能
   - 重构现有代码
   - 修复 bug
   - 添加类型定义

2. **架构设计**
   - 提供架构建议
   - 设计数据模型
   - 选择技术方案
   - 优化性能

3. **问题诊断**
   - 分析错误日志
   - 找出问题根因
   - 提供解决方案
   - 预防类似问题

4. **文档编写**
   - API 文档
   - 使用指南
   - 架构文档
   - 故障排查文档

5. **代码审查**
   - 发现潜在问题
   - 提供优化建议
   - 检查最佳实践
   - 改进代码质量

### ❌ AI 的局限性

1. **无法直接执行**
   - 不能直接运行命令
   - 不能访问外部服务
   - 不能修改生产环境

2. **需要明确指令**
   - 不能猜测隐含需求
   - 不能做主观决策
   - 需要明确的验收标准

3. **依赖提供的信息**
   - 只能基于提供的代码和文档
   - 不知道未提及的约束条件
   - 不了解团队的隐性规则

## 最佳实践示例

### 示例 1：功能开发

**好的请求：**
```
我需要在项目列表页添加批量删除功能：
1. 支持多选项目
2. 删除前需要二次确认
3. 显示删除进度
4. 使用 tRPC mutation
5. 遵循现有的 UI 设计风格（shadcn-vue）
```

**AI 会提供：**
- 完整的 Vue 组件代码
- tRPC router 更新
- Service 层实现
- 类型定义
- 错误处理

### 示例 2：问题诊断

**好的问题描述：**
```
项目初始化卡在 "创建 Kubernetes 资源" 步骤：

错误日志：
Error: namespace "project-xxx" not found

相关代码：
packages/services/business/src/gitops/flux/flux-resources.service.ts

已检查：
- K3s 集群正常运行
- kubectl 可以正常连接
- 其他项目的 namespace 存在

期望：找出为什么 namespace 没有创建成功
```

**AI 会：**
1. 分析代码逻辑
2. 检查 namespace 创建流程
3. 找出可能的竞态条件
4. 提供修复方案
5. 建议预防措施

### 示例 3：架构讨论

**好的讨论方式：**
```
当前项目初始化使用队列 + 事件驱动，但有以下问题：
1. 状态更新不够实时
2. 错误处理比较分散
3. 难以追踪整体进度

考虑引入状态机模式，你觉得：
1. 是否适合这个场景？
2. 推荐使用哪个状态机库？
3. 如何与现有的队列系统集成？
4. 需要重构哪些部分？
```

**AI 会：**
1. 分析当前架构的问题
2. 评估状态机方案的适用性
3. 推荐具体的库（如 XState）
4. 提供集成方案
5. 给出重构步骤

## 提高效率的技巧

### 1. 使用项目约定

遵循项目的命名和组织约定：
- 文件命名：kebab-case
- 类命名：PascalCase
- 函数命名：camelCase
- 目录结构：按功能模块组织

### 2. 复用现有模式

参考项目中已有的实现：
```
参考 projects.router.ts 的方式，
为 environments 创建类似的 tRPC router
```

### 3. 明确验收标准

说明什么样的结果是可接受的：
```
实现后应该满足：
1. 类型检查通过
2. 没有 ESLint 错误
3. 遵循现有的错误处理模式
4. 包含必要的日志记录
```

### 4. 批量处理相关任务

一次性处理相关的多个任务：
```
为项目管理功能添加完整的 CRUD 操作：
1. 创建项目（已有）
2. 更新项目信息
3. 删除项目
4. 归档项目
```

## 沟通风格

### 保持简洁明了

- 直接说明需求，不需要过多客套
- 使用技术术语，不需要过度解释
- 提供关键信息，省略无关细节

### 及时确认和调整

- 如果方案不对，直接说"不是这样"
- 如果需要调整，说明具体要改什么
- 如果满意，简单确认即可

### 建立共同语言

- 使用项目中的术语
- 引用具体的文件和函数
- 参考已有的实现模式

## 总结

高效的 AI 协作需要：

1. **明确的需求** - 说清楚要做什么
2. **充分的上下文** - 提供必要的背景信息
3. **具体的标准** - 说明期望的结果
4. **及时的反馈** - 快速确认或调整方向
5. **遵循约定** - 使用项目的术语和模式

记住：AI 是你的协作伙伴，不是读心术师。提供的信息越清晰，得到的结果就越准确。
