# ============================================
# Development Environment Overlay
# ============================================

apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: juanie-dev

# 基础配置
bases:
  - ../../base

# 镜像覆盖
images:
  - name: juanie/juanie
    newTag: dev

# 开发环境覆盖
patches:
  - patch: |-
      - op: replace
        path: /spec/replicas
        value: 1
    target:
      kind: Deployment
      name: juanie-web

  - patch: |-
      - op: replace
        path: /spec/minReplicas
        value: 1
      - op: replace
        path: /spec/maxReplicas
        value: 2
    target:
      kind: HorizontalPodAutoscaler
      name: juanie-web-hpa

# ConfigMap 覆盖
configMapGenerator:
  - name: juanie-config
    behavior: merge
    literals:
      - NODE_ENV=development
      - LOG_LEVEL=debug
      - ENABLE_METRICS=true
      - ENABLE_TRACING=false

# Namespace
namespace: juanie-dev

# 通用标签
commonLabels:
  environment: development
  managed-by: kustomize
